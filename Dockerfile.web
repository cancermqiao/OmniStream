FROM rust:1.93-bookworm AS builder
WORKDIR /build

RUN cargo install dioxus-cli --locked

COPY . .
WORKDIR /build/web
RUN dx build --platform web --release

FROM busybox:1.36
WORKDIR /www
COPY --from=builder /build/target/dx/app/release/web/public/ /www/
EXPOSE 8080
CMD ["httpd", "-f", "-p", "8080", "-h", "/www"]
